124.9019    4.7817
126.7328    2.1643
153.2439    -5.6500
142.8673    23.3882
152.6890    -5.5710",
header=TRUE)
my.df
# Convert data frame to sf object
my.sf.point <- st_as_sf(x = my.df,
coords = c("longitude", "latitude"),
crs = "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0")
my.sf.point
# Convert data frame to sf object
my.sf.point <- st_as_sf(x = my.df,
coords = c("longitude", "latitude"))
my.sf.point
communities
projInfo(type = "datum")
# Convert data frame to sf object
my.sf.point <- st_as_sf(x = my.df,
coords = c("longitude", "latitude"),
crs = "towgs84=0,0,0")
my.sf.point
# Convert data frame to sf object
my.sf.point <- st_as_sf(x = my.df,
coords = c("longitude", "latitude"),
crs = "+init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0")
# Convert data frame to sf object
my.sf.point <- st_as_sf(x = my.df,
coords = c("longitude", "latitude"),
crs = "+init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84 +towgs84=0,0,0")
my.sf.point
# simple plot
plot(my.sf.point)
# the given data above
my.df <- read.table(text="
longitude    latitude
128.6979    -7.4197
153.0046    -4.7089
104.3261    -6.7541
124.9019    4.7817
126.7328    2.1643
153.2439    -5.6500
142.8673    23.3882
152.6890    -5.5710",
header=TRUE)
# Convert data frame to sf object
st_as_sf(
x = stations_rollout,
coords = c("lon", "lat"),
crs = "+init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84 +towgs84=0,0,0")
# Convert data frame to sf object
stations_rollout <- st_as_sf(
x = stations_rollout,
coords = c("lon", "lat"),
crs = "+init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84 +towgs84=0,0,0")
stations_rollout
mapview(
stations_rollout,
xcol = "lon",
ycol = "lat",
zcol = "rollout_year",
grid = FALSE
)
mapview(
stations_rollout,
zcol = "rollout_year",
grid = FALSE
)
plot(stations_rollout)
plot(stations_rollout$geometry)
st_join(stations_rollout, left = FALSE, communities["community"])
st_join(communities, left = FALSE, stations_rollout)
stations_rollout %>% add_column(region, NA)
stations_rollout %>% add_column("region", NA)
stations_rollout %>% add_column(region = NA)
st_join(stations_rollout, left = FALSE, communities["community"])
?st_join()
st_join(stations_rollout, communities["community"])
st_join(stations_rollout, left = FALSE, communities["community"])
st_join(stations_rollout, left = FALSE, communities)
communities
stations_rollout
# Convert data frame to sf object
stations_rollout <- st_as_sf(
x = stations_rollout,
coords = c("lon", "lat"),
crs =
"+proj=utm +zone=19 +datum=NAD83 +units=m +no_defs
+ellps=GRS80 +towgs84=0,0,0")
stations_rollout
st_crs(4326)
# Convert data frame to sf object
stations_rollout <- st_as_sf(
x = stations_rollout,
coords = c("lon", "lat"),
crs = st_crs(4326))
stations_rollout
st_crs(stations_rollout)
st_crs(communities)
# Convert data frame to sf object
stations_rollout <- st_as_sf(
x = stations_rollout,
coords = c("lon", "lat"),
crs = st_crs("WGS84"))
View(stations_rollout)
stations_rollout
st_crs("WGS84")
# Convert data frame to sf object
stations_rollout <- st_as_sf(
x = stations_rollout,
coords = c("lon", "lat"),
st_crs("WGS84"))
stations_rollout
st_crs("WGS84")
# Convert data frame to sf object
stations_rollout <- st_as_sf(
x = stations_rollout,
coords = c("lon", "lat"))
stations_rollout
??sf
pt1 = st_point(c(0,1))
pt2 = st_point(c(1,1))
st_sfc(pt1, pt2)
d = data.frame(a = 1:2)
d$geom = st_sfc(pt1, pt2)
df = st_as_sf(d)
df
# Convert data frame to sf object
stations_rollout <- st_as_sf(
x = stations_rollout,
coords = c("lon", "lat"))
stations_rollout
st_crs(communities)
st_set_crs(communities, 4326)
st_set_crs(stations_rollout, 4326)
st_join(stations_rollout, left = FALSE, communities)
stations_rollout
stations_rollout <- st_set_crs(stations_rollout, 4326)
communities
communities <- st_set_crs(communities, 4326)
communities
stations_rollout
st_join(stations_rollout, left = FALSE, communities)
stations_rollout
rollout_region <- st_join(stations_rollout, left = FALSE, communities)
mapview(
rollout_region
)
mapview(
rollout_region, zcol = "region"
)
mapview(communities, zcol = "region") +
mapview(
rollout_region, zcol = "region"
)
mapview(communities, zcol = "region") +
mapview(
rollout_region %>% filter(region == "South Side"), zcol = "year"
)
rollout_region %>% filter(region == "South Side")
mapview(communities, zcol = "region") +
mapview(
(rollout_region %>% filter(region == "South Side")), zcol = "year"
)
mapview(communities, zcol = "region") +
mapview(
(rollout_region %>% filter(region == "South Side")), zcol = "rollout_year"
)
mapview(communities, zcol = "region") +
mapview(
(rollout_region %>% filter(region == "Far South Side")), zcol = "rollout_year"
)
mapview(communities, zcol = "region") +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year"
)
mapview(communities, zcol = "region") +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = 'x'
)
mapview(communities, zcol = "region")
communities %>% as.data.frame()
communities <- read_sf('data/violence_enforcement/communities/geo_export_45d4da8d-3fc8-4ccb-9b0c-8f546d526c9a.shp')
regions <- tibble(
community_id = c(1:77),
region = c(
"Far North Side", "Far North Side", "Far North Side", "Far North Side",
"North Side", "North Side", "North Side",
"Central",
"Far North Side", "Far North Side", "Far North Side", "Far North Side", "Far North Side", "Far North Side",
"Northwest Side", "Northwest Side", "Northwest Side", "Northwest Side", "Northwest Side", "Northwest Side",
"North Side", "North Side",
"West Side", "West Side", "West Side", "West Side", "West Side", "West Side", "West Side", "West Side", "West Side",
"Central", "Central",
"South Side", "South Side", "South Side", "South Side", "South Side", "South Side", "South Side", "South Side", "South Side", "South Side",
"Far Southeast Side", "Far Southeast Side", "Far Southeast Side", "Far Southeast Side", "Far Southeast Side", "Far Southeast Side", "Far Southeast Side", "Far Southeast Side", "Far Southeast Side", "Far Southeast Side", "Far Southeast Side", "Far Southeast Side",
"Southwest Side", "Southwest Side", "Southwest Side", "Southwest Side",
"South Side",
"Southwest Side", "Southwest Side", "Southwest Side", "Southwest Side", "Southwest Side", "Southwest Side", "Southwest Side", "Southwest Side",
"South Side",
"Far Southwest Side", "Far Southwest Side", "Far Southwest Side", "Far Southwest Side", "Far Southwest Side", "Far Southwest Side",
"Far North Side", "Far North Side"
))
communities <- communities %>%
mutate(
community = (communities$community %>% str_to_title()),
community_id = area_numbe,
community_id = as.numeric(community_id)
) %>%
arrange(community_id) %>%
left_join(regions) %>%
select(community_id, community, region, geometry)
# rename Mckinley Park to McKinley Park
filter(communities, community == "Mckinley Park")
communities[59, 2] <- "McKinley Park"
# save
saveRDS(communities, "data/communities.RDS")
communities
mapview(communities, zcol = "region")
mapview(communities, zcol = "region", col.regions=brewer.pal(9, "YlGn"))
library(RColorBrewer)
mapview(communities, zcol = "region", col.regions=brewer.pal(9, "YlGn"))
mapview(communities, zcol = "region", col.regions=brewer.pal(9, "YlGn")) +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x"
)
mapview(communities, zcol = "region", col.regions=brewer.pal(8, "YlGn")) +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x"
)
mapview(communities, zcol = "region", col.regions=brewer.pal(9, "YlGnBu")) +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x"
)
mapview(communities, zcol = "region", col.regions=brewer.pal(9, "Set 3")) +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x"
)
mapview(communities, zcol = "region", col.regions=brewer.pal(9, "Set3")) +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x"
)
mapview(communities, zcol = "region", col.regions=brewer.pal(9, "Set3")) +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x", col.regions = brewer.pal(5, "greys")
)
mapview(communities, zcol = "region", col.regions=brewer.pal(9, "Set3")) +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x", col.regions = brewer.pal(5, "Greys")
)
mapview(communities, zcol = "region") +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x", col.regions = brewer.pal(5, "Greys")
)
mapview(communities) +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x", col.regions = brewer.pal(5, "Greys")
)
mapview(communities, col.regions = brewer.pal("Greys")) +
mapview(
(rollout_region %>% filter(region == "Far Southwest Side")), zcol = "rollout_year",
legend = TRUE, layer.name = "x", col.regions = brewer.pal(5, "RdPu")
)
mapview(communities) +
mapview(
(rollout_region %>%
filter(region == "Far Southwest Side")),
zcol = "rollout_year",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(5, "RdPu")
)
mapview(communities) +
mapview(
(rollout_region %>%
filter(year == "2013")),
zcol = "region",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(5, "RdPu")
)
mapview(communities) +
mapview(
(rollout_region %>%
filter(rollout_year == "2013")),
zcol = "region",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(5, "RdPu")
)
mapview(communities) +
mapview(
(rollout_region %>%
filter(rollout_year == "2015")),
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(5, "RdPu")
)
rollout_region
rollout_year %>% unique()
stations_rollout$rollout_year %>% unique()
stations_rollout %>%
mutate(rollout_year = factor(rollout_yer,
levels = c(2013, 2015, 2016, 2017, 2018, 2019, 2020, 2021),
labels = c("2013-2015", "2013-2015", "2016-2017", "2016-2017",
"2018-2019", "2018-2019", "2020-2021", "2020-2021")
))
stations_rollout %>%
mutate(rollout_year = factor(rollout_year,
levels = c(2013, 2015, 2016, 2017, 2018, 2019, 2020, 2021),
labels = c("2013-2015", "2013-2015", "2016-2017", "2016-2017",
"2018-2019", "2018-2019", "2020-2021", "2020-2021")
))
stations_rollout %>%
mutate(rollout_year_binned = factor(rollout_year,
levels = c(2013, 2015, 2016, 2017, 2018, 2019, 2020, 2021),
labels = c("2013-2015", "2013-2015", "2016-2017", "2016-2017",
"2018-2019", "2018-2019", "2020-2021", "2020-2021")
))
stations_rollout <- stations_rollout %>%
mutate(rollout_year_binned = factor(rollout_year,
levels = c(2013, 2015, 2016, 2017, 2018, 2019, 2020, 2021),
labels = c("2013-2015", "2013-2015", "2016-2017", "2016-2017",
"2018-2019", "2018-2019", "2020-2021", "2020-2021")
))
mapview(communities) +
mapview(
(rollout_region %>%
filter(rollout_year == "2015")),
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(5, "RdPu")
)
mapview(communities) +
mapview(rollout_region,
zcol = "rollout_year_binned",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(5, "RdPu")
)
rollout_region <- rollout_region %>%
mutate(rollout_year_binned = factor(rollout_year,
levels = c(2013, 2015, 2016, 2017, 2018, 2019, 2020, 2021),
labels = c("2013-2015", "2013-2015", "2016-2017", "2016-2017",
"2018-2019", "2018-2019", "2020-2021", "2020-2021")
))
mapview(communities) +
mapview(rollout_region,
zcol = "rollout_year_binned",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(5, "RdPu")
)
mapview(communities) +
mapview(rollout_region,
zcol = "rollout_year_binned",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(5, "RdPu"),
cex = 3
)
mapview(communities, zcol = "region") +
mapview(rollout_region,
zcol = "rollout_year_binned",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(5, "RdPu"),
cex = 3
)
mapview(communities, zcol = "region",     col.regions = brewer.pal(5, "RdPu")) +
mapview(rollout_region,
zcol = "rollout_year_binned",
legend = TRUE,
layer.name = "x",
cex = 3
)
mapview(communities, zcol = "region",     col.regions = brewer.pal(5, "RdPu")) +
mapview(rollout_region,
zcol = "rollout_year_binned",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal("RdPu"),
cex = 3
)
mapview(communities, zcol = "region",     col.regions = brewer.pal("RdPu")) +
mapview(rollout_region,
zcol = "rollout_year_binned",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal("RdPu"),
cex = 3
)
mapview(communities, zcol = "region",
col.regions = brewer.pal(9,"RdPu")) +
mapview(rollout_region,
zcol = "rollout_year_binned",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(4,"RdPu"),
cex = 3
)
mapview(communities, zcol = "region",
col.regions = brewer.pal(9,"Greys")) +
mapview(rollout_region,
zcol = "rollout_year_binned",
legend = TRUE,
layer.name = "x",
col.regions = brewer.pal(4,"RdPu"),
cex = 3
)
library(shiny)
library(leaflet)
library(xts)
library(dplyr)
stations_rollout <- readRDS("data/stations_rollout.RDS")
library(lubridate)
stations_rollout %>%
mutate(rollout_year = stations_rollout$rollout_year %>% as.numeric() %>% lubridate::year())
communities <- readRDS("data/communities.RDS")
library(mapview)
library(gganimate)
library(move)
library(moveVis)
library(viridis)
stations_rollout <- stations_rollout %>%
mutate(install_year = stations_rollout$install_date %>% year())
stations_rollout
library(readxl)
bikes <- read_xlsx("data/control_vars/ride_by_comm_season_pkhrs_avgdailyemptiness_bikeavail.csv")
bikes <- read.csv("data/control_vars/stations_density_2021.csv")
bikes
View(bikes)
bikes <- read.csv("data/control_vars/ride_by_comm_season_pkhrs_avgseasonalemptiness_bikeavail.csv")
View(bikes)
bikes <- read.csv("data/control_vars/stations_density_2021.csv")
bikes
bikes <- read.csv("data/control_vars/comm_density_2021.csv")
bikes %>%
mutate(community_area = community_area %>% str_to_title())
library(tidyverse)
bikes %>%
mutate(community_area = community_area %>% str_to_title())
bikes <- bikes %>%
mutate(community_area = community_area %>% str_to_title())
bikes <- bikes %>%
mutate(community = community_area %>% str_to_title())
filter(bikes, community_area == "Mckinley Park")
bikes
bikes <- bikes %>%
mutate(community = community_area %>% str_to_title()) %>%
select(community, avg_in_2_mi_radius)
bikes <- read.csv("data/control_vars/comm_density_2021.csv")
bikes <- bikes %>%
as.tibble() %>%
mutate(community = community_area %>% str_to_title()) %>%
select(community, avg_in_2_mi_radius)
bikes <- bikes %>%
as_tibble() %>%
mutate(community = community_area %>% str_to_title()) %>%
select(community, avg_in_2_mi_radius)
bikes %>%
mutate(community = community_area %>% str_to_title()) %>%
select(community, avg_in_2_mi_radius)
bikes <- read.csv("data/control_vars/comm_density_2021.csv")
bikes %>%
mutate(community = community_area %>% str_to_title()) %>%
select(community, avg_in_2_mi_radius)
bikes %>%
tibble() %>%
mutate(community = community_area %>% str_to_title()) %>%
select(community, avg_in_2_mi_radius)
bikes %>%
tibble()
bikes <- read.csv("data/control_vars/comm_density_2021.csv") %>% tibble()
bikes <- bikes %>%
mutate(community = community_area %>% str_to_title()) %>%
select(community, avg_in_2_mi_radius)
bikes <- bikes %>%
mutate(community = community_area %>% str_to_title()) %>%
dplyr::select(community, avg_in_2_mi_radius)
bikes
filter(bikes, community == "Mckinley Park")
communities[46, 1] <- "McKinley Park"
communities[46, ]
bikes[46, ]
filter(bikes, community == "Mckinley Park")
bikes[39, ] <- "McKinley Park"
bikes[39, ]
bikes[39, 1] <- "McKinley Park"
bikes[39, 1]
left_join(communities, bikes, by = c("community" = "community"))
bikes_map <- left_join(communities, bikes, by = c("community" = "community"))
mapview(bikes_map)
library(tidyverse)
library(mapview)
mapviewOptions(fgb = FALSE)
bikes_map <- left_join(communities, bikes, by = c("community" = "community"))
mapview(bikes_map)
mapview(bikes_map, zcol = "avg_in_2_mi_radius")
View(bikes_map)
runApp('mapview app.R')
